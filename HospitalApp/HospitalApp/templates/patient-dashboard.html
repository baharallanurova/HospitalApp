{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0, user-scalable=0" name="viewport"/>
    <title>HastaneApp</title>
    <link href="{% static 'HealthStack-System/images/Normal/favicon.png' %}" rel="icon" type="image/x-icon"/>
    <link href="{% static 'HealthStack-System/css/Normal/bootstrap.min.css' %}" rel="stylesheet"/>
    <link href="{% static 'HealthStack-System/plugins/Normal/fontawesome/css/fontawesome.min.css' %}" rel="stylesheet"/>
    <link href="{% static 'HealthStack-System/plugins/Normal/fontawesome/css/all.min.css' %}" rel="stylesheet"/>
    <link href="{% static 'HealthStack-System/css/Normal/style.css' %}" rel="stylesheet"/>
</head>
<body>
<div class="main-wrapper">
    <header class="header">
        {% include 'patient_navbar.html' %}
    </header>
    <div class="breadcrumb-bar">
        <div class="container-fluid">
            <div class="row align-items-center">
                <div class="col-md-12 col-12">
                    <nav aria-label="breadcrumb" class="page-breadcrumb">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="{% url 'patient-dashboard' %}">Home</a></li>
                            <li aria-current="page" class="breadcrumb-item active">Patient Dashboard</li>
                        </ol>
                    </nav>
                    <h2 class="breadcrumb-title">Patient Dashboard</h2>
                    {% include 'message.html' %}
                </div>
            </div>
        </div>
    </div>
    <div class="content">
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-5 col-lg-4 col-xl-3 theiaStickySidebar">
                    <div>{% include 'patient-sidebar.html' %}</div>
                </div>
                <div class="col-md-7 col-lg-8 col-xl-9">
                    <div class="card">
                        <div class="card-body pt-0">
                            <nav class="user-tabs mb-4">
                                <ul class="nav nav-tabs nav-tabs-bottom nav-justified">
                                    <li class="nav-item">
                                        <a class="nav-link active" data-toggle="tab" href="#pat_appointments">Appointments</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" data-toggle="tab" href="#pat_prescriptions">Prescriptions</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" data-toggle="tab" href="#pat_medical_records">
                                            <span class="med-records">Medical Records</span>
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" data-toggle="tab" href="#pat_billing">Billing</a>
                                    </li>
                                </ul>
                            </nav>
                            <div class="tab-content pt-0">
                                <div class="tab-pane fade show active" id="pat_appointments">
                                    <div class="card card-table mb-0">
                                        <div class="card-body">
                                            <div class="table-responsive">
                                                <table class="table table-hover table-center mb-0">
                                                    <thead>
                                                        <tr>
                                                            <th>Doctor</th>
                                                            <th>Appt Date</th>
                                                            <th>Type</th>
                                                            <th>Amount</th>
                                                            <th>Status</th>
                                                            <th>Payment Status</th>
                                                            <th>Action</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        {% for appointment in appointments %}
                                                        <tr>
                                                            <td>
                                                                <h2 class="table-avatar">
                                                                    <a class="avatar avatar-sm mr-2">
                                                                        <img alt="User Image" class="avatar-img rounded-circle" src="{{ appointment.doctor.featured_image.url }}"/>
                                                                    </a>
                                                                    <a>{{ appointment.doctor.name }}<span>{{appointment.doctor.department_name}}</span></a>
                                                                </h2>
                                                            </td>
                                                            <td>
                                                                {{appointment.date}}
                                                                <span class="d-block text-info">{{appointment.time}}</span>
                                                            </td>
                                                            <td>{{appointment.appointment_type}}</td>

                                                            {% if appointment.appointment_type == 'checkup' %}
                                                            <td>{{appointment.doctor.consultation_fee}} ₹</td>
                                                            {% else %}
                                                            <td>{{appointment.doctor.report_fee}} ₹</td>
                                                            {% endif %}
                                                            <td>
                                                                {% if appointment.appointment_status == 'pending' %}
                                                                <span class="badge badge-pill bg-warning-light">Pending</span>
                                                                {% endif %}
                                                                {% if appointment.appointment_status == 'confirmed' %}
                                                                <span class="badge badge-pill bg-success-light">Confirm</span>
                                                                {% endif %}
                                                                {% if appointment.appointment_status == 'cancelled' %}
                                                                <span class="badge badge-pill bg-danger-light">Cancelled</span>
                                                                {% endif %}
                                                            </td>
                                                            <td class="text-center">
                                                                {% if appointment.payment_status == 'pending' %}
                                                                <span class="badge badge-pill bg-warning-light">Pending</span>
                                                                {% endif %}
                                                                {% if appointment.payment_status == 'VALID' %}
                                                                <span class="badge badge-pill bg-success-light">Paid</span>
                                                                {% endif %}
                                                            </td>
                                                            <td>
                                                                <div class="table-action">
                                                                    <a class="btn btn-sm bg-success-light" href="{% url 'ssl-payment-request' pk=appointment.patient.patient_id id=appointment.id %}">
                                                                        <i class="fas fa-dollar-sign"></i> Pay Now
                                                                    </a>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        {% endfor %}
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="pat_prescriptions">
                                    <div class="card card-table mb-0">
                                        <div class="card-body">
                                            <div class="table-responsive">
                                                <table class="table table-hover table-center mb-0 text-center">
                                                    <thead>
                                                        <tr>
                                                            <th>Prescription ID</th>
                                                            <th>Doctor Name</th>
                                                            <th>Doctor</th>
                                                            <th>Action</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        {% for prescription in prescription %}
                                                        <tr>
                                                            <td><a href="javascript:void(0);">{{prescription.prescription_id}}</a></td>
                                                            <td>{{prescription.doctor.name }}</td>
                                                            <td>
                                                                <h2 class="table-avatar">
                                                                    <a class="avatar avatar-sm mr-2">
                                                                        <img alt="User Image" class="avatar-img rounded-circle" src="{{prescription.doctor.featured_image.url }}"/>
                                                                    </a>
                                                                    <a>Dr. {{prescription.doctor}}<span>{{prescription.doctor.department_name}}</span></a>
                                                                </h2>
                                                            </td>
                                                            <td>
                                                                <div class="table-action">
                                                                    <a class="btn btn-sm bg-info-light" href="{% url 'prescription-view' pk=prescription.prescription_id%}">
                                                                        <i class="far fa-eye"></i> View
                                                                    </a>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        {% endfor %}
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="pat_medical_records">
                                    <div class="card card-table mb-0">
                                        <div class="card-body">
                                            <div class="table-responsive">
                                                <table class="table table-hover table-center mb-0 text-center">
                                                    <thead>
                                                        <tr>
                                                            <th>Report ID</th>
                                                            <th>Delivery Date</th>
                                                            <th>Doctor</th>
                                                            <th>Action</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        {% for report in report %}
                                                        <tr>
                                                            <td><a href="javascript:void(0);">{{report.report_id}}</a></td>
                                                            <td>{{report.delivery_date }}</td>
                                                            <td>
                                                                <h2 class="table-avatar">
                                                                    <a class="avatar avatar-sm mr-2" href="doctor-profile.html">
                                                                        <img alt="User Image" class="avatar-img rounded-circle" src="{{report.doctor.featured_image.url }}"/>
                                                                    </a>
                                                                    <a href="doctor-profile.html">Dr.{{report.doctor}} <span>{{report.doctor.department_name}}</span></a>
                                                                </h2>
                                                            </td>
                                                            <td class="text-center">
                                                                <div class="table-action">
                                                                    <a class="btn btn-sm bg-info-light" href="{% url 'view-report' pk=report.report_id%}">
                                                                        <i class="far fa-eye"></i> View
                                                                    </a>
                                                                    <a class="btn btn-sm bg-danger-light" href="{% url 'delete-report' pk=report.report_id %}" onclick="return confirm('Are you sure you want to Delete?');">
                                                                        <i class="fas fa-trash"></i> Delete
                                                                    </a>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        {% endfor %}
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="pat_billing">
                                    <div class="card card-table mb-0">
                                        <div class="card-body">
                                            <div class="table-responsive">
                                                <table class="table table-hover table-center mb-0">
                                                    <thead>
                                                        <tr>
                                                            <th>Doctor</th>
                                                            <th>Tranx ID</th>
                                                            <th>Tranx Date</th>
                                                            <th>Amount</th>
                                                            <th>Card Type</th>
                                                            <th>Card Issuer</th>
                                                            <th>Payment Status</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        {% for payment in payments %}
                                                        <tr>
                                                            <td>
                                                                <h2 class="table-avatar">
                                                                    <a class="avatar avatar-sm mr-2" href="doctor-profile.html">
                                                                        <img alt="User Image" class="avatar-img rounded-circle" src="{{payment.appointment.doctor.featured_image.url}}"/>
                                                                    </a>
                                                                    <a href="doctor-profile.html">{{payment.appointment.doctor.name}} <span>{{payment.appointment.doctor.department}}</span></a>
                                                                </h2>
                                                            </td>
                                                            <td>{{payment.transaction_id}}</td>
                                                            <td>{{payment.transaction_date}}</td>
                                                            <td>{{payment.currency_amount}} ₹</td>
                                                            <td>{{payment.card_type}}</td>
                                                            <td>{{payment.card_issuer}}</td>
                                                            <td>
                                                                {% if payment.status == 'VALID' %}
                                                                <span class="badge badge-pill bg-success-light">Success</span>
                                                                {% else %}
                                                                <span class="badge badge-pill bg-warning-light">Pending</span>
                                                                {% endif %}
                                                            </td>
                                                        </tr>
                                                        {% endfor %}
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    {% include 'footer.html' %}
</div>

<script src="{% static 'HealthStack-System/js/Normal/jquery.min.js' %}"></script>
<script src="{% static 'HealthStack-System/js/Normal/popper.min.js' %}"></script>
<script src="{% static 'HealthStack-System/js/Normal/bootstrap.min.js' %}"></script>
<script src="{% static 'HealthStack-System/plugins/Normal/theia-sticky-sidebar/ResizeSensor.js' %}"></script>
<script src="{% static 'HealthStack-System/plugins/Normal/theia-sticky-sidebar/theia-sticky-sidebar.js' %}"></script>
<script src="{% static 'HealthStack-System/Outside_assets/js/script.js' %}"></script>
<script src="{% static 'HealthStack-System/js/Normal/sidebar.js' %}"></script>

{% if messages %}
<script>
    $(document).ready(function () {
        $('.toast').toast('show');
    });
</script>
{% endif %}
</body>
</html>